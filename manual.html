<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Manual Completo - Sistema de Agendamento e Visualiza√ß√£o de Hor√°rios</title>
    <style>
        /* Conte√∫do do Stylesheet.html inserido aqui */
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            line-height: 1.6;
        }
        .container {
            max-width: 1100px;
            min-width: 300px;
            margin: 20px auto;
            background-color: #fff;
            padding: 20px 15px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            box-sizing: border-box;
        }
        h1,
        h2,
        h3 {
            color: #1a73e8;
            margin-top: 0;
            margin-bottom: 0.8em;
            line-height: 1.3;
        }
        h1 {
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5em;
            margin-bottom: 1em;
            font-size: 1.8em;
        }
        h2 {
            font-size: 1.5em;
        }
        h3 {
            font-size: 1.2em;
        }
        .filter-section h3,
        .booking-form h3 {
            margin-bottom: 1em;
        }
        p {
            margin-bottom: 1em;
        }
        hr {
            margin: 30px 0;
            border: none;
            border-top: 1px solid #e0e0e0;
        }
        a {
            color: #1a73e8;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease-in-out, text-decoration 0.2s ease-in-out;
        }
        a:hover,
        a:focus {
            color: #1558b3;
            text-decoration: underline;
            outline: none;
        }
        a:focus-visible {
            outline: 2px solid #1a73e8;
            outline-offset: 2px;
            border-radius: 2px;
        }
        button,
        .button {
            display: inline-block;
            padding: 12px 18px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 5px 10px 10px 0;
            transition: background-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            text-align: center;
            vertical-align: middle;
            width: auto;
            color: white;
            background-color: #1a73e8;
            box-sizing: border-box;
        }
        button:hover,
        .button:hover {
            background-color: #1558b3;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        button:disabled,
        .button:disabled {
            background-color: #e0e0e0;
            color: #a0a0a0;
            cursor: not-allowed;
            box-shadow: none;
        }
        button[onclick*="cancelBookingForm"] {
            background-color: #f1f3f4;
            color: #5f6368;
        }
        button[onclick*="cancelBookingForm"]:hover {
            background-color: #e8eaed;
        }
        .cancel-button {
            background-color: #dc3545;
            padding: 5px 10px;
            font-size: 0.9em;
        }
        .cancel-button:hover {
            background-color: #c82333;
        }
        .report-absence-btn {
            display: inline-block;
            color: #333;
            padding: 8px 8px;
            font-size: 1.2em;
            border-radius: 3px;
            line-height: 1;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .report-absence-btn:hover {
            background-color: #ffffff;
        }
        .action-button {
            border: none;
            cursor: pointer;
            background: none;
            opacity: 0.7;
            transition: opacity 0.3s;
            vertical-align: middle;
        }
        .slot-cell:hover .action-button {
            opacity: 1;
        }
        .absence-icon-example {
            display: inline-block;
            background-color: #ffc107;
            color: #333;
            padding: 1px 3px;
            font-size: 0.8em;
            border: 1px solid #e0a800;
            border-radius: 3px;
            line-height: 1;
            vertical-align: baseline;
            cursor: default;
        }
        .filter-section label,
        .booking-form label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.9em;
            color: #3c4043;
        }
        .filter-section select,
        .booking-form select,
        .booking-form input[type="text"] {
            width: 100%;
            padding: 10px 12px;
            margin-bottom: 18px;
            border: 1px solid #dadce0;
            border-radius: 4px;
            box-sizing: border-box;
            background-color: #fff;
            font-size: 0.95em;
            height: 40px;
            color: #333;
            line-height: normal;
        }
        .filter-section select,
        .booking-form select {
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%235f6368%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.4-5.4-12.8z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 10px auto;
            padding-right: 35px;
        }
        .filter-section select:focus,
        .booking-form select:focus,
        .booking-form input[type="text"]:focus {
            outline: none;
            border-color: #1a73e8;
            box-shadow: 0 0 0 1px #1a73e8;
        }
        .filter-section select:disabled {
            background-color: #e8eaed;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .filter-section,
        .booking-form {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #dadce0;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        .booking-form {
            margin-top: 15px;
            padding: 20px;
        }
        .booking-form p {
            margin-bottom: 1.5em;
            font-size: 0.95em;
            color: #5f6368;
            background-color: #fff;
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        .booking-form p span {
            font-weight: 500;
            color: #202124;
            display: block;
        }
        /**
         * Turma (Class/Group) Styles
         */
        .turma-schedule-container {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ccc;
        }
        .turma-schedule-container:last-child {
            border-bottom: none;
        }
        .turma-title {
            font-size: 1.4em;
            color: #1a73e8;
            margin-bottom: 15px;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
        }
        .schedule-container,
        .cancel-table-container {
            margin-top: 20px;
            overflow-x: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #fff;
            -webkit-overflow-scrolling: touch;
        }
        .cancel-table-container {
            max-height: 60vh;
            overflow-y: auto;
        }
        .schedule-container p.info-message,
        .schedule-container p.error-message {
            padding: 25px 20px;
            margin: 0;
            text-align: center;
            font-style: italic;
            font-size: 1em;
        }
        .schedule-grid-table,
        .cancel-table {
            width: 100%;
            border-collapse: collapse;
        }
        .schedule-grid-table th,
        .schedule-grid-table td,
        .cancel-table th,
        .cancel-table td {
            border: 1px solid #e0e0e0;
            padding: 8px 10px;
            vertical-align: middle;
            box-sizing: border-box;
        }
        .schedule-grid-table th,
        .cancel-table thead th {
            background-color: #f8f9fa;
            color: #3c4043;
            font-weight: 500;
            border-bottom: 2px solid #ddd;
            position: sticky;
            top: 0;
            z-index: 3;
        }
        .cancel-table thead th {
            z-index: 1;
        }
        .schedule-grid-table {
            min-width: 700px;
            table-layout: fixed;
            font-size: 0.85em;
        }
        .schedule-grid-table th,
        .schedule-grid-table td {
            padding: 4px 6px;
            text-align: center;
        }
        .schedule-grid-table td {
            background-color: #fff;
            position: relative;
            line-height: 1.3;
            min-width: 80px;
            height: 60px;
            word-wrap: break-word;
        }
        .schedule-grid-table tbody tr:nth-child(even) td {
            background-color: #f9f9f9;
        }
        .schedule-grid-table td.hour-cell {
            background-color: #e8f0fe;
            font-weight: bold;
            color: #1a73e8;
            width: 60px;
            min-width: 50px;
            position: sticky;
            left: 0;
            z-index: 2;
            padding: 6px 4px;
        }
        .schedule-grid-table tbody tr:nth-child(odd) td.hour-cell {
            background-color: #e8f0fe;
        }
        .schedule-grid-table tbody tr:nth-child(even) td.hour-cell {
            background-color: #d2e3fc;
        }
        .slot-cell {
            transition: background-color 0.15s ease-in-out;
        }
        .slot-main-content {
            margin-bottom: 1px;
        }
        .slot-status {
            display: block;
            font-size: 0.85em;
            font-style: italic;
            color: #5f6368;
            margin-top: auto;
        }
        .slot-booked-public {
            font-weight: 700;
        }
        .slot-status.status-disponivel,
        .slot-status.status-reposicao {
            color: #137333;
        }
        .slot-status.status-substituicao {
            color: #a50e0e;
        }
        .slot-empty {
            background-color: #f8f9fa;
            color: #adb5bd;
            font-style: italic;
        }
        .slot-available.slot-vago {
            background-color: #e6f4ea;
        }
        .slot-available.slot-fixo {
            background-color: #e8f0fe;
        }
        .slot-reposicao {
            background-color: #d4edda;
        }
        .slot-substituicao {
            background-color: #f8d7da;
        }
        .slot-unknown-status {
            background-color: #fff3cd;
        }
        .clickable-slot {
            cursor: pointer;
            font-weight: 500;
        }
        .clickable-slot:hover {
            background-color: #fff3cd !important;
            box-shadow: inset 0 0 0 2px #f79c00;
            z-index: 1;
        }
        .selected-cell {
            outline: 3px solid #1a73e8 !important;
            outline-offset: -2px;
            background-color: #d2e3fc !important;
            z-index: 1;
        }
        .absent-professor {
            text-decoration: line-through;
            color: #dc3545;
            font-style: italic;
        }
        .cancel-table {
            font-size: 0.9em;
        }
        .cancel-table th,
        .cancel-table td {
            text-align: left;
        }
        .cancel-table tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .cancelled-row td {
            text-decoration: line-through;
            color: #888;
            background-color: #f1f1f1 !important;
        }
        .schedule-grid-table tfoot {
            border-top: 2px solid #aaa;
            background-color: #f0f0f0;
            position: sticky;
            bottom: 0;
            z-index: 3;
        }
        .schedule-summary-row th,
        .schedule-summary-row td {
            font-weight: bold;
            font-size: 0.9em;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
            color: #333;
            min-width: 80px;
        }
        .schedule-summary-row th.summary-label {
            text-align: right;
            background-color: #e8f0fe;
            color: #1a73e8;
            position: sticky;
            left: 0;
            z-index: 4;
            background-clip: padding-box;
        }
        .schedule-summary-row td.summary-count {
            background-color: #f8f9fa;
        }
        .schedule-summary-row td.limit-reached {
            color: #d93025;
            background-color: #fce8e6;
            font-weight: 700;
        }
        .limit-indicator {
            display: block;
            font-size: 0.8em;
            font-style: italic;
            font-weight: normal;
            margin-left: 4px;
            color: inherit;
        }
        .section {
            margin-top: 30px;
            margin-bottom: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .section:last-of-type {
            border-bottom: none;
        }
        .section>p {
            font-size: 0.95em;
            color: #5f6368;
            margin-bottom: 15px;
        }
        .section>p .slot-type-vago,
        .section>p .slot-status-disponivel {
            color: #137333;
            font-weight: bold;
        }
        .section>p .slot-type-fixo {
            color: #174ea6;
            font-weight: bold;
        }
        .loading {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.85);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5em;
            color: #1a73e8;
            z-index: 1000;
        }
        .loading::before {
            content: '';
            display: block;
            width: 30px;
            height: 30px;
            margin-right: 12px;
            border-radius: 50%;
            border: 4px solid #e9ecef;
            border-top-color: #1a73e8;
            animation: spinner 0.75s linear infinite;
        }
        @keyframes spinner {
            to {
                transform: rotate(360deg);
            }
        }
        .message {
            margin-top: 20px;
            padding: 12px 18px;
            border-radius: 4px;
            text-align: center;
            word-break: break-word;
            font-size: 0.95em;
            border: 1px solid transparent;
            display: none;
        }
        .message:not(:empty) {
            display: block;
        }
        .message.success {
            background-color: #e6f4ea;
            color: #137333;
            border-color: #a8d5b3;
        }
        .message.error {
            background-color: #fce8e6;
            color: #d93025;
            border-color: #f5b4b0;
        }
        .message.info {
            background-color: #e8f0fe;
            color: #174ea6;
            border-color: #a9c5f5;
        }
        @media screen and (max-width: 768px) {
            body {
                font-size: 15px;
            }
            .container {
                padding: 15px 10px;
                margin: 10px auto;
                border-radius: 4px;
            }
            h1 {
                font-size: 1.6em;
            }
            h2 {
                font-size: 1.3em;
            }
            h3 {
                font-size: 1.1em;
            }
            button,
            .button {
                width: 100%;
                margin-right: 0;
                margin-left: 0;
                margin-bottom: 10px;
                padding: 10px 15px;
            }
            .booking-form button:last-of-type {
                margin-bottom: 0;
            }
            .filter-section select,
            .booking-form input[type="text"],
            .booking-form select {
                font-size: 1em;
                height: 44px;
                padding: 10px;
            }
            .schedule-grid-table {
                font-size: 0.8em;
                min-width: unset;
                table-layout: auto;
            }
            .schedule-grid-table th,
            .schedule-grid-table td {
                padding: 4px 5px;
                min-width: 0;
                height: auto;
                word-break: break-word;
            }
            .schedule-grid-table td {
                min-height: 50px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            .schedule-grid-table td.hour-cell {
                width: 50px;
                min-width: 45px;
                padding: 5px 2px;
                font-size: 0.9em;
                min-height: 50px;
                position: sticky;
                left: 0;
                z-index: 2;
            }
            .schedule-grid-table tbody tr:nth-child(odd) td.hour-cell {
                background-color: #e8f0fe;
            }
            .schedule-grid-table tbody tr:nth-child(even) td.hour-cell {
                background-color: #d2e3fc;
            }
            .slot-status {
                font-size: 0.85em;
            }
            .schedule-grid-table tfoot th,
            .schedule-grid-table tfoot td {
                font-size: 0.85em;
                padding: 5px;
                min-width: 0;
            }
            .schedule-summary-row th.summary-label {
                position: sticky;
                left: 0;
                z-index: 4;
            }
            .report-absence-btn {
                font-size: 1.6em;
                padding: 4px 8px;
            }
            .cancel-button {
                padding: 4px 8px;
                font-size: 0.85em;
            }
            .cancel-table {
                font-size: 0.85em;
            }
            .cancel-table th,
            .cancel-table td {
                padding: 6px 8px;
            }
        }
        @media screen and (max-width: 480px) {
            body {
                font-size: 14px;
            }
            .container {
                padding: 10px 8px;
                margin: 5px auto;
                border-radius: 0;
                box-shadow: none;
            }
            h1 {
                font-size: 1.4em;
            }
            h2 {
                font-size: 1.2em;
            }
            h3 {
                font-size: 1.1em;
            }
            button,
            .button {
                padding: 10px 12px;
                font-size: 0.95em;
            }
            .schedule-grid-table {
                font-size: 0.75em;
            }
            .schedule-grid-table th,
            .schedule-grid-table td {
                padding: 3px 4px;
            }
            .schedule-grid-table td {
                min-height: 45px;
            }
            .schedule-grid-table td.hour-cell {
                width: 40px;
                min-width: 35px;
                font-size: 0.85em;
                padding: 4px 1px;
                min-height: 45px;
            }
            .slot-status {
                font-size: 0.8em;
            }
            .schedule-grid-table tfoot th,
            .schedule-grid-table tfoot td {
                font-size: 0.8em;
                padding: 4px;
            }
            .message {
                padding: 10px 12px;
                font-size: 0.9em;
            }
            .filter-section,
            .booking-form {
                padding: 10px;
            }
            .booking-form {
                padding: 15px 10px;
            }
            .filter-section label,
            .booking-form label {
                font-size: 0.85em;
            }
            .filter-section select,
            .booking-form select,
            .booking-form input[type="text"] {
                font-size: 0.95em;
                height: 40px;
            }
        }

        /* Styles specific for documentation pages */
        .container h1 {
            margin-bottom: 20px;
        }
        .container h2 {
             margin-top: 25px;
             padding-bottom: 5px;
             border-bottom: 1px solid #eee;
        }
        .container h3 {
             margin-top: 20px;
             color: #333;
             font-size: 1.1em;
        }
        .container ul {
            margin-bottom: 1em;
            padding-left: 20px;
        }
        .container ul li {
            margin-bottom: 5px;
        }
        .container hr {
            margin: 25px 0;
        }
        .container .faq dt {
            font-weight: bold;
            margin-top: 15px;
            margin-bottom: 5px;
        }
        .container .faq dd {
            margin-left: 20px;
            margin-bottom: 10px;
            color: #555;
        }
         .container .attention {
            color: #d93025;
            font-weight: bold;
         }
    </style>
</head>
<body>
    <div class="container">
        <h1>Manual do Usu√°rio - Sistema de Agendamento e Visualiza√ß√£o de Hor√°rios</h1>

        <p>Este documento explica como utilizar o Sistema de Agendamento e Visualiza√ß√£o de Hor√°rios do IFSP, desenvolvido em Google Apps Script.</p>

        <p><strong>P√∫blico-Alvo:</strong> Professores, Coordenadores e Servidores Autorizados.</p>
        <p><strong>Guia R√°pido: <a href="/quickguide.html">Clique aqui.</a></p>

        <hr>

        <h2>1. Introdu√ß√£o</h2>
        <p>Bem-vindo(a) ao Sistema de Agendamento e Visualiza√ß√£o de Hor√°rios. Esta ferramenta foi criada para facilitar a organiza√ß√£o e o acompanhamento dos hor√°rios de aula, permitindo a visualiza√ß√£o da grade por turma e semana, bem como o agendamento de reposi√ß√µes e substitui√ß√µes e a comunica√ß√£o de aus√™ncias por usu√°rios autorizados.</p>
        <p>O sistema √© constru√≠do sobre Google Sheets e Google Apps Script. Devido √† forma como esses sistemas funcionam, <strong class="attention">a navega√ß√£o e o carregamento de dados podem ser um pouco lentos</strong>. Por favor, tenha paci√™ncia e aguarde as telas de "Carregando..." aparecerem e desaparecerem. Clicar repetidamente n√£o acelera o processo e pode causar erros.</p>
        <p>O aplicativo possui tr√™s visualiza√ß√µes principais:</p>
        <ul>
            <li><strong>P√°gina Principal (Agendamento e Visualiza√ß√£o):</strong> Onde usu√°rios autorizados (Administradores e Professores) podem filtrar e ver hor√°rios, e agendar reposi√ß√µes/substitui√ß√µes ou informar aus√™ncias.</li>
            <li><strong>Visualiza√ß√£o P√∫blica (Visualizar Agendamentos):</strong> Uma p√°gina simplificada e somente para visualiza√ß√£o, onde qualquer pessoa com o link pode ver os hor√°rios fixos e agendamentos para todas as turmas em uma determinada semana.</li>
            <li><strong>Cancelar Agendamentos:</strong> Uma p√°gina para usu√°rios autorizados (Administradores e Professores designados) visualizarem e cancelarem reservas futuras j√° agendadas.</li>
        </ul>

        <h2>2. Acesso ao Sistema</h2>
        <p>Voc√™ acessar√° o sistema atrav√©s de um link fornecido pela administra√ß√£o. √â necess√°rio estar logado(a) em uma conta Google (<code>@ifsp.edu.br</code>) que tenha sido previamente autorizada para usar o sistema.</p>
        <p>Ao acessar a p√°gina principal, voc√™ ver√° seu e-mail logado e seu Papel (por exemplo, "Admin", "Professor") exibidos. Seu papel determina quais a√ß√µes voc√™ pode realizar no sistema. Se seu papel n√£o aparecer ou voc√™ vir uma mensagem de "Acesso Negado", entre em contato com o administrador do sistema.</p>

        <h2>3. P√°gina Principal: Agendamento e Visualiza√ß√£o</h2>
        <p>Esta √© a tela principal para usu√°rios autorizados realizarem a√ß√µes no sistema.</p>

        <h3>3.1. Informa√ß√µes do Usu√°rio</h3>
        <p>No topo da p√°gina, ap√≥s o t√≠tulo, voc√™ ver√°:</p>
        <ul>
            <li><strong>Usu√°rio:</strong> Seu e-mail cadastrado.</li>
            <li><strong>Papel:</strong> Seu n√≠vel de permiss√£o no sistema (Admin ou Professor).</li>
        </ul>
        <p>Logo abaixo, h√° links para a "Visualiza√ß√£o P√∫blica" e a p√°gina de "Cancelar Agendamentos".</p>

        <h3>3.2. Filtros de Visualiza√ß√£o</h3>
        <p>Antes de ver qualquer hor√°rio, voc√™ precisa selecionar:</p>
        <ul>
            <li><strong>Turma:</strong> Escolha a turma cujos hor√°rios voc√™ deseja visualizar.</li>
            <li><strong>Semana:</strong> Selecione a semana de in√≠cio (sempre uma Segunda-feira) que voc√™ quer carregar. O sistema geralmente pr√©-seleciona a semana atual.</li>
        </ul>
        <p>Ap√≥s selecionar ambos os filtros, clique no bot√£o <strong>"Buscar Hor√°rio"</strong>.</p>

        <h3>3.3. Carregando o Hor√°rio (Aguarde!)</h3>
        <p>Ao clicar em "Buscar Hor√°rio", uma mensagem de <strong class="attention">"Carregando... Isso demora um pouco!!!"</strong> aparecer√°. <strong class="attention">Por favor, aguarde pacificamente.</strong> O sistema est√° buscando e processando os dados na planilha. Isso pode levar de alguns segundos a mais de um minuto, dependendo da quantidade de dados e da carga nos servidores do Google.</p>

        <h3>3.4. A Grade de Hor√°rios</h3>
        <p>Ap√≥s o carregamento, a grade de hor√°rios para a turma e semana selecionadas ser√° exibida.</p>
        <ul>
            <li><strong>Colunas:</strong> Os dias da semana (Segunda a S√°bado).</li>
            <li><strong>Linhas:</strong> Os hor√°rios de in√≠cio das aulas.</li>
            <li><strong>C√©lulas:</strong> Representam um slot de hor√°rio espec√≠fico (Dia + Hora) para a turma selecionada.</li>
        </ul>
        <p>Cada c√©lula pode exibir diferentes informa√ß√µes e cores, dependendo do tipo de hor√°rio original e do seu status atual:</p>
        <ul>
            <li><strong>C√©lulas Claras (Status: Dispon√≠vel):</strong>
                <ul>
                    <li><span style="color: #137333; font-weight: bold;">Verde Claro (Tipo: Vago)</span>: Indica um hor√°rio que n√£o faz parte do hor√°rio fixo da turma e est√° livre para agendamento (geralmente Reposi√ß√µes/Recupera√ß√µes). Usu√°rios autorizados podem clicar nestas c√©lulas para agendar.</li>
                    <li><span style="color: #174ea6; font-weight: bold;">Azul Claro (Tipo: Fixo)</span>: Indica um hor√°rio que faz parte do hor√°rio fixo da turma e est√° livre para agendamento de Substitui√ß√µes. Mostrar√° a disciplina e o(s) professor(es) principal(is). Usu√°rios autorizados podem clicar nestas c√©lulas para agendar.</li>
                </ul>
            </li>
            <li><strong>C√©lulas Coloridas (Status: Agendado):</strong>
                <ul>
                    <li><span style="color: #137333; font-weight: bold;">Verde (Status: Reposi√ß√£o Agendada)</span>: Indica um hor√°rio que era "Vago" e foi agendado como Reposi√ß√£o. Mostrar√° a disciplina e o professor que ir√° repor.</li>
                    <li><span style="color: #d93025; font-weight: bold;">Vermelho Claro (Status: Substitui√ß√£o Agendada)</span>: Indica um hor√°rio que era "Fixo" e foi agendado como Substitui√ß√£o. Mostrar√° a disciplina e o Professor Substituto. Se o professor original for diferente, ele pode ser indicado entre par√™nteses.</li>
                </ul>
            </li>
            <li><strong>C√©lulas Cinzas (Status: Vago sem Agendamento):</strong> Hor√°rios Vagos que n√£o foram agendados aparecem como c√©lulas vazias ou cinzas na grade. Eles n√£o s√£o clic√°veis para agendamento.</li>
            <li><strong>C√©lulas Amarelas (Status: Desconhecido/Aviso):</strong> Raramente, um status inesperado pode aparecer, indicado por amarelo.</li>
            <li><strong>Texto na C√©lula:</strong> Geralmente mostra a disciplina e o(s) Professor(es) associados.</li>
            <li><strong>Status entre Par√™nteses:</strong> Ex: <code>(Disponivel)</code>, <code>(Reposicao Agendada)</code>, <code>(Substituicao Agendada)</code>. Indica o estado atual do slot.</li>
            <li><strong>Professor(es) Ausente(s):</strong> Em hor√°rios FIXOS futuros, se um professor foi marcado como ausente, o nome dele aparecer√° riscado (<s class="absent-professor">Nome Professor</s>) na c√©lula.</li>
            <li><strong>Tooltip (Dica ao passar o mouse):</strong> Passe o mouse sobre uma c√©lula para ver mais detalhes (Data, Hora, Turma, Tipo Original, Status, Professores, Ausentes, ID).</li>
        </ul>

        <h3>3.5. Agendamento de Reposi√ß√£o/Recupera√ß√£o Paralela</h3>
        <p><strong>Quem pode agendar:</strong> Administradores e Professores.</p>
        <p><strong>Onde agendar:</strong> Em c√©lulas de hor√°rio <strong>Vago</strong> com status <strong>Dispon√≠vel</strong> (cor verde claro).</p>
        <p><strong>Como agendar:</strong></p>
        <ol>
            <li>Na grade, clique em uma c√©lula de hor√°rio <strong>Vago (verde claro)</strong> que voc√™ deseja agendar como reposi√ß√£o.</li>
            <li>A se√ß√£o "Agendar Reposi√ß√£o/Recupera√ß√£o Paralela" aparecer√° abaixo da grade com um formul√°rio.</li>
            <li>Verifique se as informa√ß√µes do "Slot Selecionado" est√£o corretas.</li>
            <li>Selecione o <strong>"Professor que ir√° repor"</strong> na lista.</li>
            <li>Selecione a <strong>"Disciplina da Reposi√ß√£o"</strong> na lista.</li>
            <li>Clique em <strong>"Confirmar Agendamento de Reposi√ß√£o/Recupera√ß√£o"</strong>.</li>
            <li>Aguarde a tela de carregamento. Uma mensagem de sucesso ou erro aparecer√°.</li>
            <li>Ap√≥s o sucesso, o formul√°rio sumir√° e a grade ser√° recarregada automaticamente para mostrar o agendamento.</li>
        </ol>

        <h3>3.6. Agendamento de Substitui√ß√£o</h3>
        <p><strong>Quem pode agendar:</strong> Administradores e Professores.</p>
        <p><strong>Onde agendar:</strong> Em c√©lulas de hor√°rio <strong>Fixo</strong> com status <strong>Dispon√≠vel</strong> (cor azul claro).</p>
        <p><strong>Como agendar:</strong></p>
        <ol>
            <li>Na grade, clique em uma c√©lula de hor√°rio <strong>Fixo (azul claro)</strong> que voc√™ deseja agendar como substitui√ß√£o.</li>
            <li>A se√ß√£o "Agendar Substitui√ß√£o" aparecer√° abaixo da grade com um formul√°rio.</li>
            <li>Verifique se as informa√ß√µes do "Slot Selecionado" est√£o corretas.</li>
            <li>Selecione o <strong>"Professor Substituto"</strong> na lista.</li>
            <li>Selecione a <strong>"Disciplina da Substitui√ß√£o"</strong> na lista.</li>
            <li>Clique em <strong>"Confirmar Agendamento de Substitui√ß√£o"</strong>.</li>
            <li>Aguarde a tela de carregamento. Uma mensagem de sucesso ou erro aparecer√°.</li>
            <li>Ap√≥s o sucesso, o formul√°rio sumir√° e a grade ser√° recarregada automaticamente para mostrar o agendamento.</li>
        </ol>

        <h3>3.7. Cancelando Formul√°rios de Agendamento/Aus√™ncia</h3>
        <p>Se voc√™ clicou em uma c√©lula mas desistiu do agendamento ou do registro de aus√™ncia, basta clicar no bot√£o <strong>"Cancelar"</strong> no formul√°rio que apareceu. O formul√°rio ser√° ocultado e a c√©lula selecionada na grade voltar√° ao normal.</p>

        <h3>3.8. Informar Aus√™ncia de Professor</h3>
        <p><strong>Quem pode informar:</strong> Administradores e Professores (geralmente apenas para si mesmos, a menos que sejam administradores de cancelamento).</p>
        <p><strong>Onde informar:</strong> Em hor√°rios <strong>Fixo</strong> futuros.</p>
        <p><strong>Como informar:</strong></p>
        <ol>
            <li>Na grade, localize a c√©lula de hor√°rio <strong>Fixo</strong> desejada (pode estar Dispon√≠vel, Reposi√ß√£o Agendada ou Substitui√ß√£o Agendada).</li>
            <li>Passe o mouse sobre a c√©lula para ver o √≠cone de calend√°rio com "X" (üìÖ‚ùå) aparecer.</li>
            <li>Clique no √≠cone üìÖ‚ùå.</li>
            <li>A se√ß√£o "Informar Aus√™ncia de Professor" aparecer√° abaixo da grade com um formul√°rio.</li>
            <li>Verifique se as informa√ß√µes do "Hor√°rio Selecionado" est√£o corretas.</li>
            <li>Selecione o <strong>"Professor Ausente"</strong> na lista (a lista mostrar√° apenas os Professores associados a este hor√°rio fixo).</li>
            <li>Clique em <strong>"Confirmar Aus√™ncia"</strong>.</li>
            <li>Aguarde a tela de carregamento. Uma mensagem de sucesso ou erro aparecer√°.</li>
            <li>Ap√≥s o sucesso, o formul√°rio sumir√° e a grade ser√° recarregada automaticamente. O nome do professor marcado como ausente aparecer√° riscado.</li>
        </ol>

        <h3>3.9. Rodap√© da Grade (Contagem Di√°ria)</h3>
        <p>Na parte inferior da grade de hor√°rios, h√° uma linha de rodap√© com a contagem total de aulas por dia da semana para a turma selecionada naquela semana. Essa contagem considera tanto os hor√°rios <strong>FIXOS</strong> quanto os hor√°rios <strong>VAGOS</strong> que foram agendados como <strong>REPOSI√á√ÉO</strong> para cada dia da semana exibido. Este sistema respeita o limite de horas-aula presenciais por dia estabelecido pelo <strong class="attention">Art. 26 ¬ß 3¬∫ da organiza√ß√£o did√°tica do IFSP</strong>.</p>
        <ul>
            <li><strong>Limite:</strong> Se a contagem para um dia atingir ou exceder este limite (atualmente configurado para 10 aulas por dia em regime integral), a c√©lula da contagem ficar√° destacada (vermelha) para indicar que o limite foi atingido. <em>Nota: Este limite √© usado pelo sistema, com base no Art. 26 ¬ß 3¬∫, para evitar a cria√ß√£o excessiva de hor√°rios VAGOS dispon√≠veis para agendamento em dias que j√° est√£o cheios com hor√°rios Fixos ou Vagos agendados.</em></li>
        </ul>

        <h2>4. Visualiza√ß√£o P√∫blica (Visualizar Agendamentos)</h2>
        <p>Esta p√°gina destina-se √† visualiza√ß√£o geral dos hor√°rios por qualquer pessoa com o link, sem necessidade de login autorizado no sistema.</p>
        <ul>
            <li><strong>Acesso:</strong> Clique no link "Visualizar Agendamentos" na p√°gina principal ou acesse o link direto fornecido.</li>
            <li><strong>Filtro:</strong> Voc√™ s√≥ pode filtrar por <strong>Semana</strong>. Selecione a semana desejada na lista e clique em "Buscar Hor√°rios".</li>
            <li><strong>Grade:</strong> A grade exibir√° os hor√°rios para <strong>todas as turmas</strong> na semana selecionada.</li>
            <li><strong>Conte√∫do:</strong> Ser√£o mostrados apenas hor√°rios que s√£o <strong>FIXOS</strong> ou que foram <strong>AGENDADOS</strong> (Reposi√ß√£o ou Substitui√ß√£o). Hor√°rios VAGOS que n√£o foram agendados <em>n√£o</em> aparecem na visualiza√ß√£o p√∫blica.</li>
            <li><strong>Funcionalidade:</strong> Esta p√°gina √© <strong class="attention">apenas para visualiza√ß√£o</strong>. Voc√™ n√£o pode clicar nas c√©lulas para agendar ou informar aus√™ncias.</li>
            <li><strong>Desempenho:</strong> O carregamento nesta p√°gina tamb√©m pode ser lento, pois ele busca dados de <em>todas</em> as turmas para a semana.</li>
        </ul>

        <h2>5. Cancelar Agendamentos</h2>
        <p>Esta p√°gina permite que usu√°rios autorizados (Administradores e Professores designados para cancelamento, ou Professores que criaram a reserva/est√£o nela como Prof. Substituto/Original) visualizem e cancelem reservas futuras.</p>
        <ul>
            <li><strong>Acesso:</strong> Clique no link "Cancelar Agendamentos" na p√°gina principal.</li>
            <li><strong>Carregar Reservas:</strong> Clique no bot√£o <strong>"Carregar Reservas Agendadas"</strong>. Aguarde a tela de carregamento. O sistema listar√° as reservas futuras que voc√™ tem permiss√£o para cancelar.</li>
            <li><strong>Lista de Reservas:</strong> Uma tabela ser√° exibida com detalhes das reservas encontradas (ID, Tipo, Data, Hora, Turma, Disciplina, Professor Substituto, Professor Original, Agendado Por).</li>
            <li><strong>A√ß√£o de Cancelar:</strong>
                <ol>
                    <li>Localize a reserva que deseja cancelar na tabela.</li>
                    <li>Clique no bot√£o <strong>"Cancelar"</strong> na coluna "A√ß√£o".</li>
                    <li>Uma janela de confirma√ß√£o aparecer√° com alguns detalhes da reserva. Leia atentamente.</li>
                    <li>Se tiver certeza, clique em "OK". Se n√£o, clique em "Cancelar".</li>
                    <li>Ao confirmar, aguarde a tela de carregamento. Uma mensagem de sucesso ou erro aparecer√°.</li>
                    <li>Em caso de sucesso, a linha da reserva na tabela ser√° riscada e o bot√£o mudar√° para "Cancelada" (desabilitado).</li>
                </ol>
            </li>
            <li><strong>Permiss√µes de Cancelamento:</strong> Voc√™ s√≥ ver√° e poder√° cancelar reservas que voc√™ criou, nas quais voc√™ est√° listado como "Professor Substituto" ou "Professor Original", ou se voc√™ tiver o papel de "Admin" ou for o "Professor Administrador de Cancelamento" configurado no sistema.</li>
        </ul>

        <h2>6. Notifica√ß√µes por E-mail</h2>
        <p>Ao realizar um agendamento (Reposi√ß√£o ou Substitui√ß√£o), o sistema enviar√° automaticamente uma notifica√ß√£o por e-mail.</p>
        <ul>
            <li><strong>Remetente:</strong> O e-mail ser√° enviado pelo sistema, com o nome "Sistema de Reservas IFSP".</li>
            <li><strong>Destinat√°rios:</strong> O e-mail ser√° enviado para:
                <ul>
                    <li>O e-mail do usu√°rio que realizou o agendamento.</li>
                    <li>Os e-mails dos professores envolvidos na reserva (o Professor Substituto e o(s) Professor(es) do hor√°rio original).</li>
                    <li>Endere√ßos de e-mail de administradores configurados para receber c√≥pias (geralmente CAE e MTM).</li>
                </ul>
            </li>
            <li><strong>Conte√∫do:</strong> O e-mail conter√° os detalhes da reserva (Tipo, Data, Hora, Turma, Disciplina, Professor envolvido, ID da Reserva, quem agendou, data/hora da cria√ß√£o).</li>
        </ul>

        <h2>7. Integra√ß√£o com Google Calendar</h2>
        <p>Quando um agendamento (Reposi√ß√£o ou Substitui√ß√£o) √© realizado com sucesso e o sistema est√° configurado com um calend√°rio, um evento correspondente ser√° criado ou atualizado neste calend√°rio.</p>
        <ul>
            <li><strong>Cria√ß√£o/Atualiza√ß√£o:</strong> O evento ser√° criado no Google Calendar especificado na configura√ß√£o do sistema. Se o slot j√° possu√≠a um evento associado de um agendamento anterior que foi cancelado, o sistema pode tentar atualizar o evento existente em vez de criar um novo.</li>
            <li><strong>Detalhes do Evento:</strong> O t√≠tulo e a descri√ß√£o do evento incluir√£o os detalhes da reserva (Tipo, Disciplina, Turma, Professores, ID da Reserva, quem agendou).</li>
            <li><strong>Convidados:</strong> Os e-mails dos professores envolvidos na reserva (Professor Substituto e Professor(es) do hor√°rio original) ser√£o adicionados como convidados ao evento do calend√°rio.</li>
            <li><strong class="attention">Evento do Google Meet: ATEN√á√ÉO!</strong> Devido a uma funcionalidade padr√£o do Google Calendar ao adicionar convidados via script, o evento <strong class="attention">automaticamente ter√° uma sala do Google Meet associada</strong>. <strong class="attention">Voc√™ pode IGNORAR essa sala de Meet</strong>. Ela n√£o √© usada pelo sistema e n√£o impede que a aula/atividade aconte√ßa presencialmente (ou onde for planejado). N√£o √© poss√≠vel desabilitar a cria√ß√£o dessa sala de Meet via Apps Script no momento.</li>
            <li><strong>Cancelamento e Calendar:</strong> Ao cancelar uma reserva pela p√°gina "Cancelar Agendamentos", o sistema tentar√° <strong class="attention">excluir</strong> o evento correspondente do Google Calendar. Isso ajuda a manter o calend√°rio atualizado. Se o evento j√° foi exclu√≠do manualmente ou houver outro erro, uma mensagem de aviso pode aparecer, mas o cancelamento no sistema (planilha) ser√° efetuado.</li>
            <li><strong>Erros no Calendar:</strong> Se o sistema encontrar problemas ao criar ou atualizar o evento no Google Calendar (por exemplo, ID do calend√°rio inv√°lido ou permiss√µes), o agendamento <strong class="attention">continuar√° v√°lido nas planilhas</strong>, mas uma mensagem de aviso ser√° exibida na tela de sucesso e inclu√≠da no e-mail de notifica√ß√£o.</li>
        </ul>

        <h2>8. Observa√ß√£o de Desempenho</h2>
        <p>Refor√ßando: O sistema depende da comunica√ß√£o com as planilhas Google e do processamento via Google Apps Script. <strong class="attention">Carregar dados, buscar hor√°rios, agendar ou cancelar podem levar algum tempo (at√© mais de um minuto)</strong>. Sempre aguarde a tela de "Carregando..." desaparecer e as mensagens de sucesso ou erro aparecerem antes de tentar qualquer outra a√ß√£o. Sua paci√™ncia √© fundamental para o bom funcionamento.</p>

        <h2>9. Perguntas Frequentes (FAQ)</h2>

        <dl class="faq">
            <dt>P: O sistema est√° muito lento. √â normal?</dt>
            <dd>R: Sim, infelizmente √© normal. O sistema funciona sobre Google Sheets e Google Apps Script, que possuem limita√ß√µes de performance para processamento e leitura/escrita de dados, especialmente com um volume maior de informa√ß√µes. Por favor, seja paciente e aguarde as opera√ß√µes serem conclu√≠das.</dd>

            <dt>P: Por que eu n√£o consigo agendar uma reposi√ß√£o ou substitui√ß√£o?</dt>
            <dd>R: Existem alguns motivos:
                <ul>
                    <li><strong>Permiss√£o:</strong> Apenas usu√°rios com papel "Admin" ou "Professor" podem agendar.</li>
                    <li><strong>Tipo de Slot:</strong> Reposi√ß√µes s√≥ podem ser agendadas em hor√°rios "Vagos" dispon√≠veis. Substitui√ß√µes s√≥ podem ser agendadas em hor√°rios "Fixos" dispon√≠veis.</li>
                    <li><strong>Status:</strong> O hor√°rio deve estar "Dispon√≠vel". Se j√° foi agendado ou tem outro status, n√£o pode ser reservado novamente.</li>
                    <li><strong>Limite Di√°rio:</strong> O sistema pode impedir a cria√ß√£o de <em>novos</em> hor√°rios VAGOS se o dia j√° atingiu o limite de aulas fixas + vagas agendadas, conforme Art. 26 ¬ß 3¬∫ da organiza√ß√£o did√°tica do IFSP. Embora voc√™ veja a grade, o clique em um Vago pode n√£o abrir o formul√°rio se o limite j√° foi atingido <em>no momento da busca</em>.</li>
                </ul>
            </dd>

            <dt>P: Por que eu n√£o consigo informar uma aus√™ncia?</dt>
            <dd>R: Apenas usu√°rios com papel "Admin" ou "Professor" podem informar aus√™ncias. Al√©m disso, geralmente, um professor s√≥ pode informar a <em>sua pr√≥pria</em> aus√™ncia, a menos que ele(a) seja um administrador ou tenha a permiss√£o de "Professor Administrador de Cancelamento".</dd>

            <dt>P: O que significa quando o nome de um professor aparece riscado na grade?</dt>
            <dd>R: Significa que aquele professor foi marcado como ausente para aquele hor√°rio espec√≠fico.</dd>

            <dt>P: O que √© a contagem no rodap√© da grade?</dt>
            <dd>R: √â a soma de hor√°rios FIXOS e hor√°rios VAGOS que foram agendados como REPOSI√á√ÉO para cada dia da semana exibido. Ajuda a ter uma ideia da ocupa√ß√£o di√°ria da turma, dentro do limite estabelecido pelo Art. 26 ¬ß 3¬∫ da organiza√ß√£o did√°tica do IFSP.</dd>

            <dt>P: Agendei algo e recebi um convite de calend√°rio com Google Meet. Preciso usar o Meet?</dt>
            <dd>R: <strong class="attention">N√£o, pode ignorar o Meet.</strong> A cria√ß√£o autom√°tica da sala de Meet √© uma caracter√≠stica padr√£o do Google Calendar quando eventos s√£o criados via scripts e convidados s√£o adicionados. A aula ou atividade agendada deve ocorrer no local e formato planejados (geralmente presencial).</dd>

            <dt>P: Se eu cancelar uma reserva pela p√°gina "Cancelar Agendamentos", o evento no meu Google Calendar tamb√©m some?</dt>
            <dd>R: Sim, o sistema tenta excluir o evento correspondente do calend√°rio configurado.</dd>

            <dt>P: Se eu agendar, mas o evento n√£o aparecer no calend√°rio, a reserva √© inv√°lida?</dt>
            <dd>R: N√£o. O agendamento principal √© registrado nas planilhas do sistema. A integra√ß√£o com o Google Calendar √© uma funcionalidade auxiliar. Se houver um erro na integra√ß√£o, a reserva <em>estar√° v√°lida no sistema</em>, mas voc√™ receber√° um aviso na tela e por e-mail.</dd>
        </dl>

        <p style="margin-top: 30px;">Esperamos que este manual ajude voc√™ a utilizar o Sistema de Agendamento e Visualiza√ß√£o de Hor√°rios de forma eficaz. Em caso de d√∫vidas, problemas ou sugest√µes, por favor, entre em contato com a equipe respons√°vel pela administra√ß√£o do sistema.</p>

        <!-- Removing the back link as it's specific to the Apps Script web app -->
        <!-- <p><a href="<?= ScriptApp.getService().getUrl() ?>">‚Üê Voltar para Agendamento Principal</a></p> -->

    </div>
</body>
</html>
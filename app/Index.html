<!-- Index.html -->
<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <?!= include('Stylesheet'); ?>
</head>
<body>
  <div class="container">
    <h1>Agendamento e Visualiza√ß√£o de Hor√°rios</h1>
    <p>Usu√°rio: <a id="user-email" href="#">Carregando...</a> | Papel: <strong id="user-role">Carregando...</strong></p>
    <p>
      <a href="<?= ScriptApp.getService().getUrl() ?>?page=public">Visualizar Agendamentos</a><span> | </span>
      <a href="<?= ScriptApp.getService().getUrl() ?>?page=cancel">Cancelar Agendamentos</a>
    </p>
    <div class="filter-section">
      <h3>Filtros de Visualiza√ß√£o</h3>
      <label for="turma-filter">Turma:</label>
      <select id="turma-filter" required>
        <option value="" disabled selected>-- Carregando Turmas --</option>
      </select>
      <label for="week-filter">Semana (come√ßando na Segunda-feira):</label>
      <select id="week-filter" required>
        <option value="" disabled selected>-- Carregando Semanas --</option>
      </select>
      <button onclick="loadFilteredSchedule()">Buscar Hor√°rio</button>
    </div>
    <hr>
    <div id="schedule-container" class="schedule-container">
      <p class="info-message">Selecione a Turma e a Semana e clique em "Buscar Hor√°rio".</p>
    </div>
    <div id="loading" class="loading" style="display: none;">Carregando... Isso demora um pouco!!!</div>
    <div id="message" class="message"></div>
    <hr>
    <div id="reposicao-section" class="section" style="display: none;">
      <h2>Agendar Reposi√ß√£o/Recupera√ß√£o Paralela</h2>
      <p>Selecione um hor√°rio <span class="slot-type-vago">VAGO</span> e <span
          class="slot-status-disponivel">DISPON√çVEL</span> na grade acima para agendar uma reposi√ß√£o.</p>
      <div id="reposicao-form" class="booking-form" style="display: none;">
        <h3>Detalhes da Reposi√ß√£o/Recupera√ß√£o Paralela</h3>
        <p>Slot Selecionado: <span id="reposicao-selected-slot-info"></span></p>
        <input type="hidden" id="reposicao-selected-slot-id">
        <label for="reposicao-professor-real">Professor que ir√° repor:</label>
        <select id="reposicao-professor-real" required>
          <option value="" disabled selected>-- Carregando Professores --</option>
        </select>
        <label for="reposicao-disciplina">Disciplina da Reposi√ß√£o:</label>
        <select id="reposicao-disciplina" required>
          <option value="" disabled selected>-- Carregando Disciplinas --</option>
        </select>
        <button onclick="bookSlot('Reposicao')">Confirmar Agendamento de Reposi√ß√£o/Recupera√ß√£o</button>
        <button type="button" onclick="cancelBookingForm('Reposicao')">Cancelar</button>
      </div>
    </div>
    <div id="substituicao-section" class="section" style="display: none;">
      <h2>Agendar Substitui√ß√£o</h2>
      <p>Selecione um hor√°rio <span class="slot-type-fixo">FIXO</span> e <span
          class="slot-status-disponivel">DISPON√çVEL</span> na grade acima para agendar uma substitui√ß√£o.</p>
      <div id="substituicao-form" class="booking-form" style="display: none;">
        <h3>Detalhes da Substitui√ß√£o</h3>
        <p>Slot Selecionado: <span id="substituicao-selected-slot-info"></span></p>
        <input type="hidden" id="substituicao-selected-slot-id">
        <label for="substituicao-professor-real">Professor Substituto:</label>
        <select id="substituicao-professor-real" required>
          <option value="" disabled selected>-- Carregando Professores --</option>
        </select>
        <label for="substituicao-disciplina">Disciplina da Substitui√ß√£o:</label>
        <select id="substituicao-disciplina" required>
          <option value="" disabled selected>-- Carregando Disciplinas --</option>
        </select>
        <button onclick="bookSlot('Substituicao')">Confirmar Agendamento de Substitui√ß√£o</button>
        <button type="button" onclick="cancelBookingForm('Substituicao')">Cancelar</button>
      </div>
    </div>
    <div id="absence-section" class="section" style="display: none;">
      <h2>Informar Aus√™ncia de Professor</h2>
      <p>Selecione um hor√°rio <span class="slot-type-fixo">FIXO</span> futuro na grade acima e clique no √≠cone <span class="absence-icon-example">üìÖ‚ùå</span> para informar uma aus√™ncia.</p>
      <div id="absence-form" class="booking-form" style="display: none;">
        <h3>Detalhes da Aus√™ncia</h3>
        <p>Hor√°rio Selecionado: <span id="absence-selected-slot-info"></span></p>
        <input type="hidden" id="absence-selected-slot-id">
        <label for="absence-professor-select">Professor Ausente:</label>
        <select id="absence-professor-select" required>
          <option value="" disabled selected>-- Selecione o Professor --</option>
        </select>
        <button onclick="submitAbsenceReport()">Confirmar Aus√™ncia</button>
        <button type="button" onclick="cancelAbsenceForm()">Cancelar</button>
      </div>
    </div>
  </div>
  <?!= include('Javascript'); ?>
</body>
</html>